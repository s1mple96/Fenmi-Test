# ETC申办工具

## 简介

本工具是一个基于 PyQt5 的 Windows 桌面应用，集成了 ETC 申办全流程自动化、数据库造数、四要素智能填充、进度日志展示等功能，适用于 ETC 业务测试、批量数据生成、流程演示等场景。

---

## 主要功能

- **ETC申办全流程自动化**：一键完成车牌校验、身份认证、协议签署、车辆信息保存、代扣支付、数据库状态更新、库存入库等全流程。
- **数据库造数**：支持多种数据类型的批量生成，自动插入数据库。
- **四要素拖拽填充**：支持将包含姓名、身份证、手机号、银行卡号的文件拖拽到界面，自动识别并填充。
- **进度与日志展示**：流程进度实时展示，详细日志倒序显示，便于调试和追踪。
- **帮助弹窗**：点击“四要素信息”标题可弹出文件格式样例，支持一键复制。
- **产品选择联动**：产品选择支持按运营商分类，动态过滤。

---

## 安装与运行

### 依赖环境
- Python 3.7+
- PyQt5 >= 5.15
- pymysql
- requests

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python winform/etc_apply_widget.py
```

---

## 使用说明

1. **填写或选择申办信息**：包括产品、车牌、省份、VIN码等。
2. **四要素智能填充**：
   - 可手动输入姓名、身份证、手机号、银行卡号。
   - 也可将包含四要素的TXT/CSV/JSON文件拖拽到“四要素信息”区域，自动填充。
   - 点击“四要素信息（支持拖拽...）”标题可弹出文件格式样例，支持一键复制。
3. **点击“一键申办ETC”**：自动执行全流程，进度条和日志实时更新。
4. **详细日志**：流程每一步、接口返回、异常等均有详细日志，便于排查。

---

## 四要素文件格式样例

支持如下格式：
```
姓名: 张三
身份证: 440011XXXXXXXXXXXX
手机号: 13221630502
银行卡号: 6222XXXXXXXXXXXXXXX
```
- 支持TXT、CSV、JSON多种格式
- 字段名、冒号、空格均可智能识别
- 拖拽到“四要素信息”区域即可自动填充

---

## 目录结构

```
Fenmi-Test/
├── winform/
│   └── etc_apply_widget.py      # 主窗口/主流程
├── ui/
│   ├── builder/                # UI构建器
│   ├── binder/                 # 信号绑定
│   ├── components/             # 组件（含四要素拖拽）
│   └── utils/                  # UI工具
├── worker/
│   └── etc/                    # 申办流程主控、API、参数、数据库
├── utils/                      # 通用工具
├── config/                     # 配置文件
├── test/                       # 测试用例
├── requirements.txt            # 依赖
└── README.md                   # 说明文档
```

---

## 常见问题

- **进度条不动？** 请确保所有流程步骤都正确调用了进度回调，且信号参数为 (percent, msg)。
- **问号按钮不显示？** 主窗口已采用内容区自定义问号按钮，点击“四要素信息”标题可弹出帮助。
- **拖拽无效？** 请检查文件格式、字段名、编码（推荐UTF-8）。

---

## 联系与支持

如有问题或建议，请联系开发者或在项目仓库提交 issue。 